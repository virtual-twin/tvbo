key: Jansen1995
title: "Electroencephalogram and visual evoked potential generation in a mathematical model of coupled cortical columns"
year: 1995
doi: 10.1007/BF00199471
derived_from: Jansen1993
label: "Jansen-Rit (1995) replication study"
description: "Single- and double-column Jansen-Rit neural mass models, parameter exploration, and evoked potentials with delayed inter-column synaptic filtering."
model:
  name: ModelJansen1995
  has_reference: "Jansen1995"
  label: "Jansen-Rit Neural Mass Model (single column)"
  description: "JR model with canonical parameters; long-range input is injected via a coupling term. Output is pyramidal potential difference."
  parameters:
    A:
      value: 3.25
      unit: mV
    B:
      value: 22
      unit: mV
    C:
      value: 135
      explored_values:
        - 68
        - 128
        - 135
        - 270
        - 675
        - 1350
    a:
      value: 0.1
      unit: ms^-1
    b:
      value: 0.05
      unit: ms^-1
    v0:
      value: 6
      unit: mV
    e0:
      value: 0.0025
      unit: ms^-1
    r:
      value: 0.56
      unit: mV^-1
    p:
      value: 0.24
      unit: ms^-1
  derived_parameters:
    C1:
      equation:
        rhs: C
    C2:
      equation:
        rhs: 0.8*C
    C3:
      equation:
        rhs: 0.25*C
    C4:
      equation:
        rhs: 0.25*C
  functions:
    Sigm:
      definition: "JR sigmoid transformation"
      arguments:
        v:
          name: v
      equation:
        rhs: 2*e0 / (1 + exp(r*(v0 - v)))
  coupling_terms:
    c_glob:
      description: "Long-range input to the pyramidal population (pre-filter)."
  state_variables:
    y0:
      label: "Pyramidal membrane potential (position)"
      equation:
        rhs: y3
      unit: mV
    y3:
      label: "Pyramidal EPSP drive (velocity)"
      equation:
        rhs: A*a*Sigm(y1 - y2) - 2*a*y3 - a**2*y0
      unit: mV*ms^-1
    y1:
      label: "Excitatory interneuron membrane potential (position)"
      equation:
        rhs: y4
      unit: mV
    y4:
      label: "Excitatory EPSP drive (velocity) with global input"
      equation:
        rhs: A*a*(p + C2*Sigm(C1*y0) + c_glob) - 2*a*y4 - a**2*y1
      unit: mV*ms^-1
    y2:
      label: "Inhibitory interneuron membrane potential (position)"
      equation:
        rhs: y5
      unit: mV
    y5:
      label: "Inhibitory IPSP drive (velocity)"
      equation:
        rhs: B*b*(C4*Sigm(C3*y0)) - 2*b*y5 - b**2*y2
      unit: mV*ms^-1
  output_transforms:
    - name: v_pyr
      description: "EEG-like output"
      equation:
        rhs: y1 - y2
      unit: mV

simulation_experiments:

  # Fig. 3-4 single-column behavior (alpha/noise regimes)
  - id: 1
    label: "Single-column spontaneous activity"
    description: "Alpha-like oscillations around C=135 with random drive; explore C."
    dynamics: ["Hypoactive Noise"]
    model:
      name: ModelJansen1995
    integration:
      method: RungeKuttaFehlberg45
      duration: 1000
      noise:
        gaussian: true
        additive: true
        correlated: false
        parameters:
          sigma:
            name: sigma
            value: 1e-5
    monitors:
      - name: Raw
        period: 1.0
        imaging_modality: EEG
        select_variable:
          name: v_pyr

  # Alternate operating point (low-frequency/quasi-periodic)
  - id: 2
    label: "Low-frequency quasi-periodic output"
    description: "Shifted operating point (A,B,C) as in parameter sweeps."
    model:
      name: ModelJansen1995
      parameters:
        A: { value: 3.12 }
        B: { value: 24 }
        C: { value: 108 }
    integration:
      method: RungeKuttaFehlberg45
      duration: 1000
      noise:
        gaussian: true
        additive: true
        correlated: false
        parameters:
          sigma:
            name: sigma
            value: 1e-5
    monitors:
      - name: Raw
        period: 1.0
        imaging_modality: EEG
        select_variable:
          name: v_pyr

  # Fig. 5: two identical columns, zero-delay coupling (symmetric behavior)
  - id: 3
    label: "Double column (identical), zero delay"
    description: "Two identical JR columns, symmetric coupling (K1=K2), no explicit synaptic delay."
    model:
      name: ModelJansen1995
    connectivity:
      number_of_regions: 2
      weights:
        x:
          values:
            - 1
            - 2
        y:
          values:
            - 1
            - 2
        values:
          - 0
          - 70
          - 70
          - 0   # example K1=K2=70 for sinusoidal regime (cf. Fig. 5 trajectory)
      lengths:
        x:
          values:
            - 1
            - 2
        y:
          values:
            - 1
            - 2
        values:
          - 0
          - 0
          - 0
          - 0     # zero-delay case
    coupling:
      name: Linear
      parameters:
        a:
          value: 1.0
          description: "Rescale long-range input"
        b:
          value: 0.0
          description: "Offset"
      pre_expression:
        lhs: pre
        rhs: v_pyr
      post_expression:
        lhs: c_glob
        rhs: a * gx + b
    integration:
      method: RungeKuttaFehlberg45
      duration: 1000
      noise:
        gaussian: true
        additive: true
        correlated: false
        parameters:
            sigma:
              name: sigma
              value: 1e-5
    monitors:
      - name: Raw
        period: 1.0
        imaging_modality: EEG
        select_variable:
          name: v_pyr

  # Fig. 6, 11 & VEPs: two different columns, delayed inter-column synaptic filtering + flash stimulus
  - id: 4
    label: "Double column with delayed branch + VEP (as in 1995)"
    description: "Two JR columns (visual alpha-like & prefrontal beta-like). Inter-column coupling uses per-source sigmoidal transform and a delayed EPSP branch (time constant a/3). Flash stimulus applied to column 1; average across trials."
    # Create a derived model that introduces ONLY the extra states used by the delayed branch
    model:
      name: ModelJansen1995_DelayedBranch
      derived_from_model:
        name: ModelJansen1995
      modified: true
      # New coupling input (after sigmoid & network sum) and delayed-branch states
      coupling_terms:
        c_in:
          description: "Network-summed, sigmoidal presynaptic drive for delayed EPSP."
      state_variables:
        # Delayed EPSP (2nd-order) driven by c_in with time constant a/3 (per Jansen & Rit, Eq. 7-8)
        z0:
          label: "Delayed-branch EPSP (position)"
          equation:
            rhs: z1
          unit: mV
          variable_of_interest: false
        z1:
          label: "Delayed-branch EPSP (velocity)"
          equation:
            rhs: A*(a/3)*c_in - 2*(a/3)*z1 - (a/3)**2*z0
          unit: mV*ms^-1
          variable_of_interest: false
        # Override pyramidal drive to include filtered long-range input (z0) and stimulus (flash)
        y4:
          label: "Excitatory EPSP drive with delayed branch + stimulus"
          equation:
            rhs: A*a*(p + flash + C2*Sigm(C1*y0) + z0) - 2*a*y4 - a**2*y1
    connectivity:
      number_of_regions: 2
      # Visual (node 1) → Prefrontal (node 2): K1 large; feedback K2 smaller (Pandya & Yeterian, 1990)
      weights:
        x:
          values:
            - 1
            - 2
        y:
          values:
            - 1
            - 2
        values:
          - 0
          - 1000
          - 300
          - 0   # K1=1000, K2=300
      lengths:
        x:
          values:
            - 1
            - 2
        y:
          values:
            - 1
            - 2
        values:
          - 0
          - 100
          - 100
          - 0    # ~100 mm pathways
      conduction_speed:
        name: conduction_speed
        value: 3.0
        unit: mm/ms                 # ~3 m/s ⇒ ~33 ms for 100 mm (consistent with a/3 branch latency)
    # Per-source sigmoid BEFORE weighting (closer to Eq. 8), then summed and injected to c_in
    coupling:
      name: SigmoidalJansenRit
      parameters:
        midpoint:
          value: 6.0
          description: "Midpoint v0"
        cmax:
          value: 0.005
          description: "2*e0 in ms^-1 units"
        r:
          value: 0.56
          description: "Steepness"
        a:
          value: 1.0
          description: "Rescale network input"
        cmin:
          value: 0.0
          description: "Minimum of sigmoid"
      sparse: false
      pre_expression:
        lhs: pre
        rhs: cmin + (cmax - cmin)/(exp(r*(midpoint - v_pyr)) + 1.0)
      post_expression:
        lhs: c_in
        rhs: a*gx
    # Make columns different: column 1 (visual) α-like; column 2 (prefrontal) β-like
    # Do this by setting per-node parameter overrides via additional_equations (lightweight and local).
    additional_equations:
      - label: "Column-specific parameters"
        rhs: |
          # Node 1 (visual): keep defaults (A=3.25,B=22,C=135)
          # Node 2 (prefrontal): beta-like settings used in the paper (A'=3.25, B'=17.6, C'=108)
          A[2] = 3.25
          B[2] = 17.6
          C[2] = 108
    # Flash stimulus P(t) = q ((t-t0)/w)^n exp(-(t-t0)/w) to node 1 only, added to 'flash' symbol used in y4
    stimulation:
      name: Flash
      description: "Flash visual input to column 1 (Eq. 18)"
      parameters:
        q:   { value: 0.5 }
        w:
          value: 0.005
          unit: s
        n:
          value: 7
        t0:
          value: 6.0
          unit: s
          description: "Onset after 6 s settling"
      equation:
        # Produces 'flash' (0 before t0; Eq. 18 after t0)
        rhs: "(t >= t0) * q * (((t - t0)/w)**n) * exp(- (t - t0)/w)"
      regions:
        - 1      # apply to node 1 only
      weighting:
        - 1.0
      duration: 0.2
    integration:
      method: RungeKuttaFehlberg45
      duration: 7.0
      transient_time: 6.0
      noise:
        gaussian: true
        additive: true
        correlated: false
        seed: 42
        parameters:
          sigma:
            name: sigma
            value: 5e-6
    monitors:
      - name: Raw
        period: 1.0
        imaging_modality: EEG
        select_variable:
          name: v_pyr
    # Note: To replicate Fig. 8-11, run 20-40 trials with different noise seeds and average v_pyr offline.

  # Canonical alpha regime using s^-1 units (unit check)
  - id: 5
    label: "Alpha activity (s^-1 units for a,b,e0)"
    description: "Unit consistency check; same operating point but a,b,e0 in s^-1."
    model:
      name: ModelJansen1995
      parameters:
        a:
          value: 100
          unit: s^-1
        b:
          value: 50
          unit: s^-1
        e0:
          value: 2.5
          unit: s^-1
    integration:
      method: RungeKuttaFehlberg45
      duration: 1000
    monitors:
      - name: Raw
        period: 1.0
        imaging_modality: EEG
        select_variable:
          name: v_pyr