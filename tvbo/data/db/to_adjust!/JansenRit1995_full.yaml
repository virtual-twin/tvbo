key: JansenRit1995
title: Electroencephalogram and visual evoked potential generation in a mathematical model of coupled cortical columns
year: 1995
doi: 10.1007/BF00199471
derived_from: Jansen1993

# Base model definition (single cortical column) — referenced by experiments below
model:
  name: JansenRitCorticalColumn
  label: Jansen–Rit 1995 cortical column
  description: |
    Single-column neural mass model (pyramidal population with excitatory and inhibitory feedback) per Jansen & Rit (1995).
    Equations follow the 6-state ODE form with sigmoid nonlinearity and parameters A, B, a, b, e0, v0, r, and connectivity C (or C1..C4).

  parameters:
    # Core physiological parameters (defaults around alpha regime)
    A: { value: 3.25, unit: mV }
    B: { value: 22.0, unit: mV }
    a: { value: 0.1, unit: ms^-1 }
    b: { value: 0.05, unit: ms^-1 }
    v0: { value: 6.0, unit: mV }
    e0: { value: 0.0025, unit: ms^-1 }
    r:  { value: 0.56, unit: mV^-1 }
    C:  { value: 135 }
    # Optional constant drive p (when not using explicit Noise/Stimulus)
    p:  { value: 0.24, description: "Mean external input (arbitrary units); can be superseded by noise/stimulus" }

  derived_parameters:
    C1:
      equation: { rhs: C }
    C2:
      equation: { rhs: 0.8 * C }
    C3:
      equation: { rhs: 0.25 * C }
    C4:
      equation: { rhs: 0.25 * C }

  functions:
    Sigm:
      arguments:
        v:
      equation:
        rhs: 2*e0 / (1 + e**(r*(v0 - v)))

  state_variables:
    # y0..y5 and their first derivatives per Eq. (6)
    y0:
      label: pyramidal_potential
      unit: mV
      equation: { rhs: y3 }
    y3:
      label: dy0_dt
      unit: mV ms^-1
      equation:
        rhs: A*a*Sigm(y1 - y2) - 2*a*y3 - (a**2)*y0
    y1:
      label: excitatory_feedback_potential
      unit: mV
      equation: { rhs: y4 }
    y4:
      label: dy1_dt
      unit: mV ms^-1
      equation:
      # Base form includes external drive p; experiments may override to add coupling term(s)
        rhs: A*a*(p + C2*Sigm(C1*y0)) - 2*a*y4 - (a**2)*y1
    y2:
      label: inhibitory_feedback_potential
      unit: mV
      equation: { rhs: y5 }
    y5:
      label: dy2_dt
      unit: mV ms^-1
      equation:
        rhs: B*b*(C4*Sigm(C3*y0)) - 2*b*y5 - (b**2)*y2

  derived_variables:
    EEG:
      description: "Proxy EEG signal as excitatory minus inhibitory PSP"
      unit: mV
      equation: { rhs: y1 - y2 }

  # Declare an optional coupling term name that experiments may enable by overriding y4
  coupling_terms:
    c_glob:

# Experiments representing the study’s main figures/conditions
simulation_experiments:
  - id: 1
    label: Single-column spontaneous activity (parameter sweep)
    description: |
      Explore spontaneous activity regimes by varying C while keeping other parameters at default alpha-like values.
      Replicates evolution from noise → noisy alpha → alpha → quasi-periodic spike-wave → noise-like, as in Fig. 3/4.
    model:
      name: JansenRitCorticalColumn
      parameters:
        C:
          value: 135
          explored_values: [68, 128, 135, 270, 675, 1350]
    integration:
      method: RK45
      step_size: 0.0005     # 0.5 ms
      duration: 6.0         # seconds
      transient_time: 1.0   # seconds before analysis
    monitors:
      - name: EEG
        imaging_modality: EEG
        period: 0.001       # 1 ms sampling for output
    # Optionally add background white noise by replacing constant p with stimulus/noise in later runs

  - id: 2
    label: Double-column (identical), no delay — coupling sweep
    description: |
      Two identical columns (visual cortex proxy) coupled bidirectionally without delay; vary K1, K2 via asymmetric weights.
      Observe synchronization, waxing/waning, and frequency shifts as coupling increases, as in Fig. 5.
    # Use identical base model for both nodes
    model:
      name: JansenRitCorticalColumn
      # Override y4 to include global coupling term contributed by network inputs
      state_variables:
        y4:
          equation:
            rhs: A*a*(p + C2*Sigm(C1*y0) + c_glob) - 2*a*y4 - (a**2)*y1
    network:
      number_of_regions: 2
      node_labels: [col1, col2]
      weights:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        # Off-diagonals carry K-values; set explored ranges if desired
        # Example default K1=K2=10; can be varied externally
        values: [0, 10, 10, 0]   # [[0, K1],[K2, 0]]
      lengths:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 0, 0, 0]    # no delay
      conduction_speed:
        value: 1.0
    coupling:
      name: Linear
      delayed: false
    integration:
      method: RK45
      step_size: 0.0005
      duration: 6.0
      transient_time: 1.0
    monitors:
      - name: EEG
        imaging_modality: EEG
        period: 0.001

  - id: 3
    label: Double-column (visual vs prefrontal), with delays — spontaneous activity
    description: |
      Two coupled columns representing visual (alpha-like) and prefrontal (beta-like) areas, with intercolumn transmission delays.
      Parameters follow paper defaults: column 1 standard; column 2 tuned to beta-like (A'=3.25, B'=17.6, C'=108).
      Explore K1 (feedforward) roughly an order of magnitude stronger than K2 (feedback), per anatomical evidence.
    # Heterogeneous node dynamics
    model:
      node_dynamics:
        - name: JansenRitCorticalColumn   # visual cortex-like
        - name: JansenRitCorticalColumn   # prefrontal-like
          parameters:
            B: { value: 17.6, unit: mV }
            C: { value: 108 }
      node_dynamics_mapping: [0, 1]
      # Override y4 on both to include c_glob
      state_variables:
        y4:
          equation:
            rhs: A*a*(p + C2*Sigm(C1*y0) + c_glob) - 2*a*y4 - (a**2)*y1
    network:
      number_of_regions: 2
      node_labels: [visual, prefrontal]
      weights:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 1000, 200, 0]   # [[0, K1],[K2, 0]]; example K1>>K2
      lengths:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 0.033, 0.033, 0]  # ~33 ms one-way delays
      conduction_speed:
        value: 1.0                     # so delay ≈ length
    coupling:
      name: Linear
      delayed: true
    integration:
      method: RK45
      step_size: 0.0005
      duration: 6.0
      transient_time: 1.0
    monitors:
      - name: EEG
        imaging_modality: EEG
        period: 0.001

  - id: 4
    label: Evoked potentials — identical columns, no delay (stimulus to column 1)
    description: |
      Replicates multicomponent VEP responses in two identical coupled columns without delay.
      A gamma-shaped transient P(t)=q*(t/w)^n*exp(-t/w) is applied to column 1 on top of background.
    model:
      name: JansenRitCorticalColumn
      state_variables:
        y4:
          equation:
            rhs: A*a*(p + C2*Sigm(C1*y0) + c_glob) - 2*a*y4 - (a**2)*y1
    network:
      number_of_regions: 2
      node_labels: [col1, col2]
      weights:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 10, 10, 0]
      lengths:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 0, 0, 0]
      conduction_speed:
        value: 1.0
    coupling:
      name: Linear
      delayed: false
    stimulation:
      label: flash
      regions: [0]           # stimulate column 1
      duration: 0.5
      parameters:
        n: { value: 7 }
        w: { value: 0.005 }  # seconds
        q: { value: 0.5 }
      equation:
        rhs: q*(t/w)**n * e**(-t/w)
    integration:
      method: RK45
      step_size: 0.0005
      duration: 6.5         # run long enough pre/post stimulus
      transient_time: 6.0   # apply stimulus after settling
    monitors:
      - name: EEG
        imaging_modality: EEG
        period: 0.001

  - id: 5
    label: Evoked potentials — visual→prefrontal with delay (stimulus to visual)
    description: |
      Two different columns with delayed interconnections; stimulus applied to the visual node.
      Observe N1/P1 latencies and waveform classes as a function of K1/K2, per Fig. 11.
    model:
      node_dynamics:
        - name: JansenRitCorticalColumn   # visual
        - name: JansenRitCorticalColumn   # prefrontal
          parameters:
            B: { value: 17.6, unit: mV }
            C: { value: 108 }
      node_dynamics_mapping: [0, 1]
      state_variables:
        y4:
          equation:
            rhs: A*a*(p + C2*Sigm(C1*y0) + c_glob) - 2*a*y4 - (a**2)*y1
    network:
      number_of_regions: 2
      node_labels: [visual, prefrontal]
      weights:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 4000, 100, 0]   # K1 >> K2 example
      lengths:
        x: { values: [0, 1] }
        y: { values: [0, 1] }
        values: [0, 0.033, 0.033, 0]
      conduction_speed:
        value: 1.0
    coupling:
      name: Linear
      delayed: true
    stimulation:
      label: flash
      regions: [0]
      duration: 0.5
      parameters:
        n: { value: 7 }
        w: { value: 0.005 }
        q: { value: 0.5 }
      equation:
        rhs: q*(t/w)**n * e**(-t/w)
    integration:
      method: RK45
      step_size: 0.0005
      duration: 6.5
      transient_time: 6.0
    monitors:
      - name: EEG
        imaging_modality: EEG
        period: 0.001
